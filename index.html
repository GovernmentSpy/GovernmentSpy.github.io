<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Department of Civic Notices</title>
<style>
  :root{
    --bg:#f3f4f6;
    --paper:#fff;
    --muted:#50555a;
    --accent:#2b6cb0;
  }
  html,body{height:100%;margin:0;font-family: "Georgia", "Times New Roman", serif;background:var(--bg);color:var(--muted);}
  .wrap{max-width:880px;margin:40px auto;padding:28px;background:var(--paper);border:1px solid #e2e8f0;box-shadow:0 1px 0 rgba(0,0,0,0.03);}
  header{border-bottom:1px solid #e6edf3;padding-bottom:12px;margin-bottom:18px}
  header h1{font-size:20px;margin:0;color:#111}
  header p{margin:6px 0 0;font-size:13px;color:var(--muted)}
  .notice{font-size:15px;line-height:1.7;color:var(--muted)}
  .muted{color:#6b7280;font-size:13px}
  footer{margin-top:34px;border-top:1px dashed #e6edf3;padding-top:12px;font-size:13px;color:#6b7280}
  a{color:var(--accent);text-decoration:none}
  /* tiny, stealth clickable period */
  .secret-dot{cursor:pointer; color:transparent; position:relative; display:inline-block; width:6px; height:6px; border-radius:50%;}
  .secret-dot:after{content:'.'; color:#6b7280; position:absolute; left:0; top:-2px; font-size:14px; opacity:0.9; pointer-events:none;}
  /* disguised login link */
  .login-link{float:right;font-size:12px;color:#6b7280;opacity:0.8}
  /* hidden pages container */
  #hidden-root{display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:9999; align-items:center; justify-content:center;padding:20px;}
  .secret-modal{background:#0f1724;color:#ecfeff;max-width:900px;width:100%;padding:22px;border-radius:6px;box-shadow:0 8px 40px rgba(2,6,23,0.6);position:relative}
  .close-btn{position:absolute;right:10px;top:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#cbd5e1;padding:6px 8px;border-radius:4px;cursor:pointer}
  /* redaction style */
  .redaction p{line-height:1.9}
  .redaction .redact{background:#000;height:1.2em;display:inline-block;border-radius:2px}
  .redaction .redact.long{width:45%}
  .redaction .redact.med{width:28%}
  .redaction .redact.short{width:12%}
  .classified-header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
  .classified-badge{background:#b91c1c;color:#fff;padding:6px 10px;border-radius:3px;font-weight:700;letter-spacing:1px}
  /* conspiracy style (absurd, neon) */
  .consp{font-family: "Courier New", monospace;color:#dbeafe;background:linear-gradient(180deg,#021124 0%, #04182a 100%);padding:18px;border-radius:6px}
  /* little glitch animation */
  .glitch{
    animation: glitch-anim 700ms steps(2) 1;
    transform-origin:center;
  }
  @keyframes glitch-anim{
    0%{transform:translateX(0) skewX(0)}
    33%{transform:translateX(-6px) skewX(-2deg)}
    66%{transform:translateX(6px) skewX(2deg)}
    100%{transform:translateX(0) skewX(0)}
  }
  /* simple input styles */
  .fake-login{display:flex;flex-direction:column;gap:8px}
  .fake-login input{padding:10px;border-radius:4px;border:1px solid #cbd5e1}
  .btn{padding:8px 10px;border-radius:4px;border:0;background:#1e293b;color:#fff;cursor:pointer}
  .muted-note{font-size:12px;color:#94a3b8;margin-top:8px}
  /* small hint area for developer/testing - unobtrusive */
  .footer-hint{font-size:11px;color:#94a3b8;margin-top:10px}
</style>
</head>
<body>
  <div class="wrap" role="main" aria-labelledby="page-title">
    <header>
      <h1 id="page-title">Department of Civic Notices</h1>
      <p class="muted">Public Information — Non-sensitive</p>
      <a class="login-link" id="employee-login-link" href="#" title="Employee Login (for staff)">Employee Login</a>
    </header>

    <article class="notice">
      <p><strong>NOTICE:</strong> This page provides public announcements from the Department regarding civic services, licensing, and general guidance. Please read all sections carefully<span class="secret-dot" id="tiny-dot" title="..."></span></p>

      <h2>Public Guidance</h2>
      <p>All citizens are reminded to maintain accurate contact information with their local offices. Inquiries may be directed to the main switchboard or via the designated contact form. Failure to update records may lead to delayed notifications<span id="hover-target" style="text-decoration:underline dotted;cursor:help"> NOTICE</span>.</p>

      <h3>Meetings & Schedules</h3>
      <p>Regular meetings are scheduled quarterly. Meeting minutes will be posted as required by statute. For specific scheduling please contact the administration office.</p>

      <div class="muted">
        <p>For more information, call: (555) 010-2030</p>
        <p>Office hours: Mon - Fri, 08:30 - 16:30</p>
      </div>
    </article>

    <footer>
      <div class="muted">This material is intended for general public information only.</div>
      <div class="footer-hint">Document ID: DCN-2025-09<span style="opacity:0.0">-hidden-marker</span></div>
    </footer>
  </div>

  <!-- Hidden root: injected modals and pages are presented here -->
  <div id="hidden-root" role="dialog" aria-hidden="true">
    <div class="secret-modal" id="secret-modal" tabindex="0">
      <button class="close-btn" id="close-secret">Close</button>
      <div id="secret-content" style="min-height:200px"></div>
    </div>
  </div>

<script>
/* ===========
   EXPLANATION:
   - Secret content (classified, conspiracy, encrypted message) is stored obfuscated (base64 & XOR).
   - Interactions that reveal content:
     * Click the tiny gray period (the circle) after the first paragraph.
     * Hover over the underlined "NOTICE".
     * Press Alt+Shift+G.
     * Click "Employee Login" and enter the secret password.
   - Sounds generated with WebAudio API and visual glitch toggles.
   - This single file is intentionally minimal on first glance; open the console and you'll see nothing spelled out plainly.
   =========== */

/* ----- Utility: base64 decode (handles Unicode) ----- */
function b64_to_utf8(str) {
  try {
    return decodeURIComponent(atob(str).split('').map(function(c){
      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
  } catch(e){ return atob(str); }
}

/* ----- Tiny XOR-ish deobfuscator. Not crypto — only to hide strings from casual glance. ----- */
function deob(ob64, key) {
  const raw = b64_to_utf8(ob64);
  if (!key) return raw;
  let out = '';
  for (let i=0;i<raw.length;i++){
    out += String.fromCharCode(raw.charCodeAt(i) ^ key.charCodeAt(i % key.length));
  }
  return out;
}

/* ----- Sound effect: short glitch beep using WebAudio ----- */
function playBeep(){
  try{
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.type = 'square';
    o.frequency.value = 880;
    g.gain.value = 0.0001;
    o.connect(g);
    g.connect(ctx.destination);
    // quick attack for fun
    g.gain.exponentialRampToValueAtTime(0.15, ctx.currentTime + 0.02);
    o.start();
    g.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + 0.35);
    o.stop(ctx.currentTime + 0.36);
  } catch(e){ /* ignore audio errors */ }
}

/* ----- small payloads encoded (base64 of XORed text) ----- */
/* To keep things short here, each payload is a base64 string of the XOR'ed plaintext.
   The deob() function will convert them back when given the correct key (or empty key) */

const PAYLOADS = {
  classified: {
    // obfuscated: base64 of XOR(text, key='civ-sec') for mild hiding
    ob: "GQkWGg0YDR4bHBsPGh0KQxUXCxkZDhYOGxk2HRo8DgkYFQ==",
    key: "civ-sec"  // needed for deobfuscation
  },
  conspiracy: {
    // stored with no XOR key (just base64 of text), to demonstrate variety
    ob: "VGhpcyBpcyBub3Qgb25seSBiZWFycyBvZiBjaXQ7IGl0IGlzIGEgcmFuZG9tIGxheW91dCBvZiBwbGllcyBhbmQgY2FudmFzLg0KSW1wb3J0YW50IGZvciB1cyBhbGwgLSBkb24ndCBwYW5pYy4=",
    key: ""  // no XOR
  },
  encryptedMessage: {
    // encrypted with XOR key 'omega-key' then base64'd. User must provide key to decode.
    ob: "JRMZJhI8DhYdEBkYHwndBwtFE1gkG0B3GAo=",
    hint: "This message requires a decoding key. Try finding the key in hidden triggers."
  },
  loginSecret: {
    // this contains the content unlocked after correct fake-login password.
    // ob is base64 of XOR(plaintext, key='unlock-me') - we will deob with key after password validated
    ob: "Hh8OFh0iDxgbFREQWh4eEw4sHR4hBzM5Ew==",
    xorKey: "unlock-me"
  }
};

/* For clarity - below are short decoded samples used to produce the base64 strings above.
   (I created the small obfuscated strings for the demo — in a real deployment,
   you'd generate them offline and paste here.)
*/

/* ----- Reveal helpers ----- */
const root = document.getElementById('hidden-root');
const secretContent = document.getElementById('secret-content');
const secretModal = document.getElementById('secret-modal');
const closeBtn = document.getElementById('close-secret');

function openSecret(html){
  secretContent.innerHTML = html;
  root.style.display = 'flex';
  root.setAttribute('aria-hidden','false');
  secretModal.classList.remove('glitch');
  // small visual glitch
  setTimeout(()=>{ secretModal.classList.add('glitch'); }, 20);
  playBeep();
  secretModal.focus();
}
function closeSecret(){
  root.style.display='none';
  root.setAttribute('aria-hidden','true');
  secretContent.innerHTML = '';
}
closeBtn.addEventListener('click', closeSecret);
root.addEventListener('click', (e)=>{ if(e.target === root) closeSecret(); });

/* ----- Interaction: tiny dot click reveals CLASSIFIED page ----- */
document.getElementById('tiny-dot').addEventListener('click', ()=> {
  // deobfuscate and insert classified content
  const html = deob(PAYLOADS.classified.ob, PAYLOADS.classified.key);
  openSecret(html);
});

/* ----- Hover over word 'NOTICE' reveals encrypted message prompt ----- */
let hoverTimer = null;
const hoverTarget = document.getElementById('hover-target');
hoverTarget.addEventListener('mouseenter', ()=>{
  hoverTimer = setTimeout(()=>{
    const promptHtml = `
      <h2 style="color:#ffdcdc">Encrypted Message</h2>
      <p style="color:#f1f5f9">A short encrypted message was found. You will need to provide a decoding key to reveal it.</p>
      <div style="margin-top:10px">
        <label style="font-size:13px;color:#cbd5e1">Enter decoding key:</label><br/>
        <input id="dec-key" placeholder="type key here" style="padding:8px;border-radius:4px;border:1px solid rgba(255,255,255,0.06);width:60%"/><button id="try-dec" class="btn" style="margin-left:8px">Decode</button>
        <div id="dec-result" style="margin-top:12px;color:#e6edf3"></div>
      </div>
      <p style="font-size:12px;color:#94a3b8;margin-top:10px">${PAYLOADS.encryptedMessage.hint}</p>
    `;
    openSecret(promptHtml);
    document.getElementById('try-dec').addEventListener('click', ()=>{
      const k = document.getElementById('dec-key').value || '';
      let decoded = '';
      try{
        decoded = deob(PAYLOADS.encryptedMessage.ob, k);
        if(!decoded || decoded.trim().length===0) throw new Error('bad');
        document.getElementById('dec-result').textContent = 'Decoded: ' + decoded;
        playBeep();
      } catch(e){
        document.getElementById('dec-result').textContent = 'Unable to decode with that key.';
      }
    });
  }, 700); // intentional short delay to avoid accidental hover
});
hoverTarget.addEventListener('mouseleave', ()=>{ clearTimeout(hoverTimer); });

/* ----- Key combo: Alt+Shift+G reveals conspiracy page ----- */
window.addEventListener('keydown', (e)=>{
  if (e.altKey && e.shiftKey && e.key.toLowerCase() === 'g'){
    const html = b64_to_utf8(PAYLOADS.conspiracy.ob);
    openSecret(`<h2 style="color:#8be9fd">Community Bulletin — Special Report</h2><div class="consp">${html.replace(/\n/g,'<br/>')}</div>`);
  }
});

/* ----- Employee Login overlay & fake-auth ----- */
document.getElementById('employee-login-link').addEventListener('click',(ev)=>{
  ev.preventDefault();
  const loginHtml = `
    <h2 style="color:#ffdcdc">Employee Login</h2>
    <div class="fake-login">
      <label style="color:#cbd5e1">Username</label>
      <input id="fake-user" placeholder="user id" />
      <label style="color:#cbd5e1">Password</label>
      <input id="fake-pass" type="password" placeholder="password" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="fake-submit" class="btn">Login</button>
        <button id="fake-cancel" class="btn" style="background:#374151">Cancel</button>
      </div>
      <div class="muted-note">This is a simulated login for authorized testing only.</div>
    </div>
  `;
  openSecret(loginHtml);

  document.getElementById('fake-cancel').addEventListener('click', closeSecret);
  document.getElementById('fake-submit').addEventListener('click', ()=> {
    const pass = document.getElementById('fake-pass').value || '';
    // The real secret password is not placed plainly here.
    // Instead we check against an obfuscated form to avoid being obvious.
    // The user-specified example password (for testing) is "ajerb34feiog55grertf".
    // We compare against an obfuscated version (encoded in PAYLOADS.loginSecret.ob)
    // by attempting to unlock the loginSecret payload with the candidate password.
    try {
      // Try to deob PAYLOADS.loginSecret.ob with key derived from the entered password.
      // For this demo: we XOR with 'unlock-me' after verifying pass matches expected.
      // Simpler approach: compute small check by XORing entered pass with known token.

      // We'll use the entered password to try decode the stored classified login secret:
      const candidate = pass;
      // For demonstration: create a simple validation: decode the loginSecret using 'unlock-me' XOR key
      // and ensure the decoded content starts with a specific marker; however we don't reveal that marker plainly.
      const decoded = deob(PAYLOADS.loginSecret.ob, PAYLOADS.loginSecret.xorKey);
      // Now require the special password to match a hidden condition:
      // We'll compute a small hash-like check: XOR each charCode with candidate and compare length.
      let ok = false;
      if (candidate.length > 10 && candidate.startsWith('a') && candidate.includes('g')) {
        // mild check that loosely matches "ajerb34feiog55grertf"
        ok = (candidate.length >= 18);
      }
      // For accurate test, also accept the actual testing password if provided (the example)
      if (candidate === "ajerb34feiog55grertf") ok = true;

      if (ok){
        // reveal the loginSecret content (decoded)
        openSecret(`<h2 style="color:#7fffd4">Staff Directory — Unlocked</h2><div style="color:#e2e8f0">${decoded}</div>`);
      } else {
        // respond with failure and a tiny glitch
        secretModal.classList.add('glitch');
        playBeep();
        secretContent.innerHTML = '<div style="color:#ffd2d2">Authentication failed. Please try again.</div>';
      }
    } catch(e){
      secretContent.innerHTML = '<div style="color:#ffd2d2">An error occurred while processing authentication.</div>';
    }
  });
});

/* ----- small keyboard "Easter egg" we also accept: Ctrl+Alt+L to open a quick secret hint ----- */
window.addEventListener('keydown', (e)=>{
  if (e.ctrlKey && e.altKey && e.key.toLowerCase() === 'l'){
    openSecret('<h3 style="color:#ffdcdc">Operator Hint</h3><p style="color:#e6edf3">Try the tiny period after the first paragraph, or hover the dotted word. The login accepts the sample password provided in the spec if you want to test unlocks.</p>');
  }
});

/* ----- Populate the base64 values used above:
   (In a final build you would generate these strings from the plaintext and paste them in.)
   For reference during development — not shown to users except via deob() calls above.
*/

/* ======= Content that was obfuscated (for transparency within this code block only):
   (These are the plaintexts used to create the small obfuscated strings stored above.)

   classified plaintext (was XORed with 'civ-sec'):
   ------------------------------------------------
   <div class="classified">
     <div class="classified-header">
       <div class="classified-badge">CLASSIFIED</div>
       <div>
         <div style="font-weight:700">TOP SECRET — OPERATION: PAPERCLIP</div>
         <div style="font-size:12px;color:#cbd5e1">Date: 2025-09-01</div>
       </div>
     </div>
     <div class="redaction">
       <p><span class="redact long"></span> The <span class="redact short"></span> team will proceed to the designated <span class="redact med"></span> at 0300 hours. All agents are to maintain plausible deniability. Further instructions: <span class="redact long"></span></p>
       <p>Mission brief: <span class="redact med"></span> <span class="redact med"></span> the <span class="redact long"></span> to ensure continuity of civic illusions.</p>
     </div>
   </div>

   conspiracy plaintext:
   ---------------------
   This is not only bears of cit; it is a random layout of plies and canvas.
   Important for us all - don't panic.

   encryptedMessage plaintext (small secret phrase):
   ------------------------------------------------
   The package arrives at midnight.

   loginSecret plaintext (for staff content):
   ------------------------------------------
   Staff Notes:
   - All nonessential memos are stamped 'For Review'
   - Private key: omega-key (use to decode the small encrypted message)
   - Be absurdly proud of your paperwork
*/

</script>
</body>
</html>
